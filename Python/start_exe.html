<!DOCTYPE html>
<html lang="ja">

<head>

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Y.W Works</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="ポートフォリオサイト">
<meta name="keywords" content="VBA,Python,プログラマ,エンジニア,コード">
<link rel="shortcut icon" href="./ico/favicon.ico">
<link rel="apple-touch-icon" href="./ico/apple-touch-icon.png">
<link rel="icon" type="image/png" href="./ico/android-chrome-192x192.png">
<link rel="stylesheet" type="text/css" href="/Works/style.css">
<link rel="stylesheet" href="/Works/prism.css">
<script src="/Works/js/prism.js" defer></script>

</head>


<body>

<div id="container">

<header>

<br/>
<br/>
<h1><a href="/Works/index.html" class="title"><img src="/Works/img/YW_Works.png" alt="Y.W Works" width="60%" height="60%"></a></h1>　ポートフォリオサイト

<div class="content">
<br/>
<br/>
<a href="/Works/index.html" class="menu">HOME</a>
<a href="/Works/VBA.html" class="menu">VBA</a>
<a href="/Works/HTML_CSS.html" class="menu">HTML/CSS</a>
<a href="/Works/Python.html" class="menu">Python</a>
</div>

</header>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y24BD0K2VY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y24BD0K2VY');
</script>

<hr>

<h2>Python</h2>
<p>＞一斉起動(exe化)</p>
<br/>
<br/>

<p>フォルダ内のアプリをまとめて起動する機能を、</p>
<p>Pyinstallerでexe化。</p>
<br/>
<br/>

<img src="/Works/img/Start.png" alt="アイコン">
<br/>
<br/>

<pre>
<code class="language-Python">
import os
import winshell
import subprocess
from time import sleep

#フォルダ指定
folder_path = './Start'

#相対パスを絶対パスに変換
abs_folder_path = os.path.abspath(folder_path)

#フォルダの有無をチェック
if not os.path.exists(folder_path):
    #フォルダがない場合は作成
    os.makedirs(folder_path)
    #併せてサンプルテキストを作成
    text = open('./Start/sample.txt','w')
    #テキスト編集
    text.write('ご利用ありがとうございます。\nStartフォルダを作成しましたので、\n起動したいファイル、ショートカット等を格納し、\n再度、Start.exeを実行してください。')
    text.close()
    #作成したフォルダを開く
    subprocess.Popen(['explorer', abs_folder_path], shell=True)
    #起動待ち
    sleep(1)

#フォルダ内のファイルを取得
files = [f for f in os.listdir(abs_folder_path)]

#順番にファイルを開く
for file in files:
    file_path = os.path.join(abs_folder_path, file)
    shortcut = winshell.shortcut(file_path)
    shortcut_path = shortcut.path
    os.startfile(shortcut_path)
</code>
</pre>

<br/>

<pre>
<code class="language-Python">
#exe化
pyinstaller Start.py --onefile --noconsole --icon=Start.ico
</code>
</pre>

<footer>
<small>Copyright&copy; Y.Watanabe All Rights Reserved.</small>
</footer>

</div>
<!--/container-->

</body>
</html>
